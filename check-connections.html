<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Verificar Conex√µes</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            color: #f0a500;
            padding: 20px;
            line-height: 1.6;
        }
        .location {
            background: #2a2a2a;
            border: 2px solid #f0a500;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .hotspot {
            background: #3a3a3a;
            padding: 8px;
            margin: 5px 0;
            border-left: 3px solid #4CAF50;
        }
        .no-connection {
            color: #ff4444;
            font-weight: bold;
        }
        .has-connection {
            color: #4CAF50;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>üîó Verifica√ß√£o de Conex√µes</h1>
    <div id="result">Carregando...</div>

    <script>
        async function checkConnections() {
            try {
                const response = await fetch('api/locations/list.php');
                const data = await response.json();

                if (!data.success) {
                    document.getElementById('result').innerHTML = `<div class="no-connection">Erro: ${data.message}</div>`;
                    return;
                }

                const locations = data.data.locations;
                const frente = locations.find(l => l.id === 'casa_abandonada_02_frente');
                const sala = locations.find(l => l.id === 'casa_abandonada_02_sala');

                let html = '';

                // Verificar casa_abandonada_02_frente
                if (frente) {
                    html += `<div class="location">`;
                    html += `<h2>üìç casa_abandonada_02_frente</h2>`;
                    html += `<h3>Hotspots de navega√ß√£o:</h3>`;

                    const navHotspots = frente.hotspots.filter(h => h.type === 'navigation');
                    if (navHotspots.length === 0) {
                        html += `<p class="no-connection">‚ùå Nenhum hotspot de navega√ß√£o encontrado</p>`;
                    } else {
                        navHotspots.forEach(h => {
                            const arrow = h.arrow_direction ? `‚å®Ô∏è ${h.arrow_direction}` : '';
                            const isSala = h.target_location === 'casa_abandonada_02_sala';
                            const cssClass = isSala ? 'has-connection' : '';
                            html += `<div class="hotspot ${cssClass}">
                                ${h.label} ‚Üí ${h.target_location} ${arrow}
                                ${isSala ? ' ‚úÖ CONECTA COM SALA!' : ''}
                            </div>`;
                        });
                    }
                    html += `</div>`;
                } else {
                    html += `<div class="location"><h2 class="no-connection">‚ùå casa_abandonada_02_frente n√£o encontrada no banco</h2></div>`;
                }

                // Verificar casa_abandonada_02_sala
                if (sala) {
                    html += `<div class="location">`;
                    html += `<h2>üìç casa_abandonada_02_sala</h2>`;
                    html += `<h3>Hotspots de navega√ß√£o:</h3>`;

                    const navHotspots = sala.hotspots.filter(h => h.type === 'navigation');
                    if (navHotspots.length === 0) {
                        html += `<p class="no-connection">‚ùå Nenhum hotspot de navega√ß√£o encontrado</p>`;
                    } else {
                        navHotspots.forEach(h => {
                            const arrow = h.arrow_direction ? `‚å®Ô∏è ${h.arrow_direction}` : '';
                            const isFrente = h.target_location === 'casa_abandonada_02_frente';
                            const cssClass = isFrente ? 'has-connection' : '';
                            html += `<div class="hotspot ${cssClass}">
                                ${h.label} ‚Üí ${h.target_location} ${arrow}
                                ${isFrente ? ' ‚úÖ CONECTA COM FRENTE!' : ''}
                            </div>`;
                        });
                    }
                    html += `</div>`;
                } else {
                    html += `<div class="location"><h2 class="no-connection">‚ùå casa_abandonada_02_sala n√£o encontrada no banco</h2></div>`;
                }

                // Resumo
                html += `<div class="location">`;
                html += `<h2>üìä Resumo</h2>`;

                const frenteToSala = frente?.hotspots.some(h => h.type === 'navigation' && h.target_location === 'casa_abandonada_02_sala');
                const salaToFrente = sala?.hotspots.some(h => h.type === 'navigation' && h.target_location === 'casa_abandonada_02_frente');

                html += `<p class="${frenteToSala ? 'has-connection' : 'no-connection'}">
                    casa_abandonada_02_frente ‚Üí casa_abandonada_02_sala: ${frenteToSala ? '‚úÖ SIM' : '‚ùå N√ÉO'}
                </p>`;

                html += `<p class="${salaToFrente ? 'has-connection' : 'no-connection'}">
                    casa_abandonada_02_sala ‚Üí casa_abandonada_02_frente: ${salaToFrente ? '‚úÖ SIM' : '‚ùå N√ÉO'}
                </p>`;

                html += `</div>`;

                document.getElementById('result').innerHTML = html;

            } catch (error) {
                document.getElementById('result').innerHTML = `<div class="no-connection">Erro: ${error.message}</div>`;
                console.error(error);
            }
        }

        checkConnections();
    </script>
</body>
</html>
